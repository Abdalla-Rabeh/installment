import{aq as te,b0 as ae,b5 as le,A as X,b1 as se,P as M,ad as ne,w as G,aC as z,ae as Y,f as a,O as oe,ak as N,b2 as ie,aF as re,b6 as ue,l as de,I as x,b7 as ce,m as me,p as fe,v as ve,aR as he,x as be,y as ge,z as pe,M as ye,a9 as Ve,B as Pe,ao as W,ac as De,c as k,aS as T,L as A,j as C,b8 as q,aO as Ie,aP as B,r as we,o as U,a2 as j,U as d,a5 as P,e as o,Q as m,Z as F,Y as w,X as E,b as _e,aQ as Se,R as K,b3 as Ce,b9 as Le,aY as ke,g as Ne,_ as Q,S as Ae,$ as $e,a3 as Re}from"./index.70035ea2.js";import{G as xe}from"./index.7d8c5f1f.js";import{V as Te}from"./VForm.cb86e4c2.js";const Be=te()({name:"VDialog",inheritAttrs:!1,props:{fullscreen:Boolean,origin:{type:String,default:"center center"},retainFocus:{type:Boolean,default:!0},scrollable:Boolean,modelValue:Boolean,...ae({transition:{component:le}})},emits:{"update:modelValue":e=>!0},setup(e,l){let{attrs:i,slots:y}=l;const t=X(e,"modelValue"),{scopeId:u}=se(),b=M();function s(f){var D,_;const v=f.relatedTarget,h=f.target;if(v!==h&&(D=b.value)!=null&&D.contentEl&&(_=b.value)!=null&&_.globalTop&&![document,b.value.contentEl].includes(h)&&!b.value.contentEl.contains(h)){const g=[...b.value.contentEl.querySelectorAll('button, [href], input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])')].filter(R=>!R.hasAttribute("disabled")&&!R.matches('[tabindex="-1"]'));if(!g.length)return;const $=g[0],S=g[g.length-1];v===$?S.focus():$.focus()}}return ne&&G(()=>t.value&&e.retainFocus,f=>{f?document.addEventListener("focusin",s):document.removeEventListener("focusin",s)},{immediate:!0}),G(t,async f=>{if(await z(),f){var D;(D=b.value.contentEl)==null||D.focus({preventScroll:!0})}else{var _;(_=b.value.activatorEl)==null||_.focus({preventScroll:!0})}}),Y(()=>a(ie,N({modelValue:t.value,"onUpdate:modelValue":f=>t.value=f,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen,"v-dialog--scrollable":e.scrollable}],transition:e.transition,scrollStrategy:"block",ref:b,"aria-role":"dialog","aria-modal":"true",activatorProps:{"aria-haspopup":"dialog","aria-expanded":String(t.value)},"z-index":2400},u,i),{activator:y.activator,default:()=>{var f;return a(oe,{root:!0},{default:()=>[(f=y.default)==null?void 0:f.call(y)]})}})),re({},b)}});function Ue(){const e=M([]);ue(()=>e.value=[]);function l(i,y){e.value[y]=i}return{refs:e,updateRef:l}}const Fe=de({name:"VPagination",props:{activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1===0},totalVisible:[Number,String],firstIcon:{type:x,default:"$first"},prevIcon:{type:x,default:"$prev"},nextIcon:{type:x,default:"$next"},lastIcon:{type:x,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...ce(),...me(),...fe(),...ve(),...he(),...be({tag:"nav"}),...ge(),...pe({variant:"text"})},emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,l){let{slots:i,emit:y}=l;const t=X(e,"modelValue"),{t:u,n:b}=ye(),{isRtl:s}=Ve(),{themeClasses:f}=Pe(e),D=M(-1);W(void 0,{scoped:!0});const{resizeRef:_}=De(n=>{if(!n.length)return;const{target:r,contentRect:c}=n[0],p=r.querySelector(".v-pagination__list > *");if(!p)return;const V=c.width,L=p.offsetWidth+parseFloat(getComputedStyle(p).marginRight)*2,ee=e.showFirstLastPage?5:3;D.value=Math.max(0,Math.floor(+((V-L*ee)/L).toFixed(2)))}),v=k(()=>parseInt(e.length,10)),h=k(()=>parseInt(e.start,10)),g=k(()=>e.totalVisible?parseInt(e.totalVisible,10):D.value>=0?D.value:v.value),$=k(()=>{if(v.value<=0||isNaN(v.value)||v.value>Number.MAX_SAFE_INTEGER)return[];if(g.value<=1)return[t.value];if(v.value<=g.value)return T(v.value,h.value);const n=g.value%2===0,r=n?g.value/2:Math.floor(g.value/2),c=n?r:r+1,p=v.value-r;if(c-t.value>=0)return[...T(Math.max(1,g.value-1),h.value),e.ellipsis,v.value];if(t.value-p>=(n?1:0)){const V=g.value-1,L=v.value-V+h.value;return[h.value,e.ellipsis,...T(V,L)]}else{const V=Math.max(1,g.value-3),L=V===1?t.value:t.value-Math.ceil(V/2)+h.value;return[h.value,e.ellipsis,...T(V,L),e.ellipsis,v.value]}});function S(n,r,c){n.preventDefault(),t.value=r,c&&y(c,r)}const{refs:R,updateRef:Z}=Ue();W({VPaginationBtn:{color:A(e,"color"),border:A(e,"border"),density:A(e,"density"),size:A(e,"size"),variant:A(e,"variant")}});const H=k(()=>$.value.map((n,r)=>{const c=p=>Z(p,r);if(typeof n=="string")return{isActive:!1,key:`ellipsis-${r}`,page:n,props:{ref:c,ellipsis:!0,icon:!0,disabled:!0}};{const p=n===t.value;return{isActive:p,key:n,page:b(n),props:{ref:c,ellipsis:!1,icon:!0,disabled:!!e.disabled||e.length<2,elevation:e.elevation,rounded:e.rounded,color:p?e.activeColor:e.color,ariaCurrent:p,ariaLabel:u(p?e.currentPageAriaLabel:e.pageAriaLabel,r+1),onClick:V=>S(V,n)}}}})),I=k(()=>{const n=!!e.disabled||t.value<=h.value,r=!!e.disabled||t.value>=h.value+v.value-1;return{first:e.showFirstLastPage?{icon:s.value?e.lastIcon:e.firstIcon,onClick:c=>S(c,h.value,"first"),disabled:n,ariaLabel:u(e.firstAriaLabel),ariaDisabled:n}:void 0,prev:{icon:s.value?e.nextIcon:e.prevIcon,onClick:c=>S(c,t.value-1,"prev"),disabled:n,ariaLabel:u(e.previousAriaLabel),ariaDisabled:n},next:{icon:s.value?e.prevIcon:e.nextIcon,onClick:c=>S(c,t.value+1,"next"),disabled:r,ariaLabel:u(e.nextAriaLabel),ariaDisabled:r},last:e.showFirstLastPage?{icon:s.value?e.firstIcon:e.lastIcon,onClick:c=>S(c,h.value+v.value-1,"last"),disabled:r,ariaLabel:u(e.lastAriaLabel),ariaDisabled:r}:void 0}});function O(){var n;const r=t.value-h.value;(n=R.value[r])==null||n.$el.focus()}function J(n){n.key===q.left&&!e.disabled&&t.value>e.start?(t.value=t.value-1,z(O)):n.key===q.right&&!e.disabled&&t.value<h.value+v.value-1&&(t.value=t.value+1,z(O))}return Y(()=>a(e.tag,{ref:_,class:["v-pagination",f.value],role:"navigation","aria-label":u(e.ariaLabel),onKeydown:J,"data-test":"v-pagination-root"},{default:()=>[a("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&a("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[i.first?i.first(I.value.first):a(C,N({_as:"VPaginationBtn"},I.value.first),null)]),a("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[i.prev?i.prev(I.value.prev):a(C,N({_as:"VPaginationBtn"},I.value.prev),null)]),H.value.map((n,r)=>a("li",{key:n.key,class:["v-pagination__item",{"v-pagination__item--is-active":n.isActive}],"data-test":"v-pagination-item"},[i.item?i.item(n):a(C,N({_as:"VPaginationBtn"},n.props),{default:()=>[n.page]})])),a("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[i.next?i.next(I.value.next):a(C,N({_as:"VPaginationBtn"},I.value.next),null)]),e.showFirstLastPage&&a("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[i.last?i.last(I.value.last):a(C,N({_as:"VPaginationBtn"},I.value.last),null)])])]})),{}}}),Ee={data(){return{store:xe(),formData:{cardTypeId:1,name:"",phone:"",sponsorName:"",sponsorPhone:"",statusId:null,address:"",job:"",registerationNumber:""},cardTypeResponse:[],statusResponse:[],id:null,columns:[{label:this.$t("tableColumnNo"),field:"lineNumber",sortable:!1},{label:this.$t("name"),field:"name"},{label:this.$t("numberOfActiveInstallements"),field:"numberOfActiveInstallements"},{label:this.$t("totalPaidPrice"),field:"totalPaidPrice"},{label:this.$t("totalUnpaidPrice"),field:"totalUnpaidPrice"},{label:this.$t("actions"),field:"actions",sortable:!1}],rows:[],currentPage:1,pageSize:10,total:null,paginationOptions:{enabled:!0,mode:"records",position:"top",dropdownAllowAll:!0,nextLabel:this.$t("next"),prevLabel:this.$t("prev"),rowsPerPageLabel:this.$t("Rowsperpage"),ofLabel:"of",pageLabel:"page",allLabel:"All"},selectedItem:[{value:null,title:this.$t("Allcustomers")},{value:!1,title:this.$t("Payingcustomers")},{value:!0,title:this.$t("Nonpayingcustomers")}],fliterItem:[{value:"name",title:this.$t("name")},{value:"phone",title:this.$t("phone")},{value:"registerationNumberId",title:this.$t("registerationNumber")}],hasActiveInstallement:null,filter:"name",name:null,phone:null,registerationNumberId:null,searchValue:"",dialog:!1,notifications:!1,sound:!0,widgets:!1}},computed:{computedTableData(){return this.rows.map((e,l)=>({...e,lineNumber:l+1}))}},watch:{hasActiveInstallement(){this.getData()},currentPage(){this.getData()},filter(){this.adjustFilter()}},mounted(){this.getData(),this.getCard()},methods:{async getData(){try{const e=await B.post("Clients/GetClients",{pageNumber:this.currentPage,pageSize:this.pageSize,name:this.name,phone:this.phone,registerationNumberId:this.registerationNumberId,hasActiveInstallement:this.hasActiveInstallement});this.total=e.data.count,this.rows=e.data.list}catch(e){console.error("Error fetching data:",e)}},async handlePageChange(e){this.currentPage=e,await this.getData()},editRow(e){console.log(e),this.dialog=!0,this.id=e.id,this.formData.address=e.address,this.formData.balance=e.balance,this.formData.cardTypeId=e.cardType.id,this.formData.statusId=e.clientStatus.id,this.formData.job=e.job,this.formData.name=e.name,this.formData.numberOfActiveInstallements=e.numberOfActiveInstallements,this.formData.phone=e.phone,this.formData.registerationNumber=e.registerationNumber,this.formData.sponsorName=e.sponsorName,this.formData.sponsorPhone=e.sponsorPhone,this.formData.totalPaidPrice=e.totalPaidPrice,this.formData.totalUnpaidPrice=e.totalUnpaidPrice},async edit(){await B.put("Clients/UpdateClient",{...this.formData,id:this.id}).then(()=>{this.getData(),this.dialog=!1})},async deleteRow(e,l){const i=this.$t;this.$swal.fire({title:i("Areyousoreu"),text:i("youwont"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:i("no"),confirmButtonText:i("yesDel")}).then(y=>{y.isConfirmed&&B.delete(`Clients/DeleteClient?clientId=${e}`).then(()=>{this.$swal.fire({title:i("deleted"),text:i("de"),icon:"success"}),this.rows.splice(l,1)}).catch(t=>{console.error("Error deleting:",t)})})},changePage(e){this.currentPage=e,this.getData()},add(){this.$router.push("customers/add")},details(e){this.store.ClientData=e,console.log(this.store.ClientData),console.log(this.store),this.$router.push({name:"customers-details",params:{details:e.id}})},Serach(){this.resetPagination(),this.adjustFilter(),this.getData()},resetPagination(){this.currentPage=1},adjustFilter(){this.searchValue.length!=0?this.filter=="name"?(this.name=this.searchValue,this.phone=null,this.registerationNumberId=null):this.filter=="phone"?(this.name=null,this.phone=this.searchValue,this.registerationNumberId=null):this.filter=="registerationNumberId"&&(this.name=null,this.phone=null,this.registerationNumberId=this.searchValue):(this.name=null,this.phone=null,this.registerationNumberId=null)},async getCard(){await B.get("Settings/GetGeneralSettings").then(e=>{this.cardTypeResponse=e.data.data.cardTypeResponse.map(l=>({title:l.type,value:l.id})),this.statusResponse=e.data.data.statusResponse.map(l=>({title:l.text,value:l.id}))})}}},je={class:"mt-3"},ze={class:"card custom-card"},Me={class:"card-header p-3 tx-medium my-auto tx-white custom-card-header border-bottom-0 bg-primary d-flex justify-content-between"},Oe={class:"main-content-label on-secondary my-auto tx-medium"},Ge={class:"card-options"},We={class:"card-body"},qe={key:0},Ke=["onClick"],Qe=["onClick"],Xe=["onClick"],Ye={key:1},Ze={class:"card custom-card"},He={class:"card-header p-3 tx-medium my-auto tx-white custom-card-header border-bottom-0 bg-primary d-flex justify-content-between"},Je={class:"main-content-label on-secondary my-auto tx-medium"},et={class:"card custom-card"},tt={class:"card-header p-3 tx-medium my-auto tx-white custom-card-header border-bottom-0 bg-primary d-flex justify-content-between"},at={class:"main-content-label on-secondary my-auto tx-medium"};function lt(e,l,i,y,t,u){const b=we("VueGoodTable");return U(),j(Re,null,[d("div",null,[d("div",null,[d("div",je,[d("div",ze,[d("div",Me,[d("h5",Oe,P(e.$t("Lcustomers")),1),d("div",Ge,[d("button",{class:"btn bg-success",onClick:l[0]||(l[0]=(...s)=>u.add&&u.add(...s))},P(e.$t("Addcustomer")),1)])]),d("div",We,[a(E,{class:"mb-3"},{default:o(()=>[a(m,{cols:"12",md:"3"},{default:o(()=>[a(F,{modelValue:t.hasActiveInstallement,"onUpdate:modelValue":l[1]||(l[1]=s=>t.hasActiveInstallement=s),label:e.$t("Select"),items:t.selectedItem},null,8,["modelValue","label","items"])]),_:1}),a(m,{cols:"12",md:"5"},{default:o(()=>[a(w,{modelValue:t.searchValue,"onUpdate:modelValue":l[2]||(l[2]=s=>t.searchValue=s),label:e.$t("serach"),placeholder:e.$t("serach")},null,8,["modelValue","label","placeholder"])]),_:1}),a(m,{cols:"12",md:"1"},{default:o(()=>[d("button",{class:"btn bg-info",onClick:l[3]||(l[3]=(...s)=>u.Serach&&u.Serach(...s))},P(e.$t("serach")),1)]),_:1}),a(m,{cols:"12",md:"3"},{default:o(()=>[a(F,{modelValue:t.filter,"onUpdate:modelValue":l[4]||(l[4]=s=>t.filter=s),label:e.$t("Select"),items:t.fliterItem},null,8,["modelValue","label","items"])]),_:1})]),_:1}),a(b,{columns:t.columns,rows:u.computedTableData,"select-options":{enabled:!1},"search-options":{enabled:!1,placeholder:e.$t("serach")}},{"table-row":o(s=>[s.column.field=="actions"?(U(),j("span",qe,[d("button",{class:"btn bg-info me-2",onClick:f=>u.details(s.row)},P(e.$t("details")),9,Ke),d("button",{type:"button",class:"btn bg-success on-secondary me-2",onClick:f=>u.editRow(s.row)},P(e.$t("Edit")),9,Qe),d("button",{class:"btn bg-danger me-2",onClick:f=>u.deleteRow(s.row.id,s.index)},P(e.$t("Delete")),9,Xe)])):(U(),j("span",Ye,P(s.formattedRow[s.column.field]),1))]),_:1},8,["columns","rows","search-options"]),t.pageSize>1?(U(),_e(Fe,{key:0,modelValue:t.currentPage,"onUpdate:modelValue":l[5]||(l[5]=s=>t.currentPage=s),class:"my-4",length:Math.ceil(t.total/t.pageSize),onInput:u.getData},null,8,["modelValue","length","onInput"])):Se("",!0)])])])])]),a(E,{justify:"center"},{default:o(()=>[a(Be,{modelValue:t.dialog,"onUpdate:modelValue":l[16]||(l[16]=s=>t.dialog=s),fullscreen:"",scrim:!1,transition:"dialog-bottom-transition"},{default:o(()=>[a(K,{style:Ce({direction:e.$i18n.locale==="ar"?"rtl":"ltr"})},{default:o(()=>[a(Le,{color:"primary"},{default:o(()=>[a(ke),a(C,{icon:"",class:"bg-primary on-secondary",onClick:l[6]||(l[6]=s=>t.dialog=!1)},{default:o(()=>[a(Ne,null,{default:o(()=>[Q("mdi-close")]),_:1})]),_:1})]),_:1}),a(E,null,{default:o(()=>[a(m,{cols:"12",md:"12"},{default:o(()=>[a(K,null,{default:o(()=>[a(Ae,null,{default:o(()=>[a(Te,{onSubmit:$e(u.edit,["prevent"])},{default:o(()=>[a(E,null,{default:o(()=>[a(m,{cols:"12",md:"12"},{default:o(()=>[d("div",Ze,[d("div",He,[d("h5",Je,P(e.$t("Customerdata")),1)])])]),_:1}),a(m,{cols:"12",md:"6"},{default:o(()=>[a(w,{modelValue:t.formData.name,"onUpdate:modelValue":l[7]||(l[7]=s=>t.formData.name=s),label:e.$t("name"),placeholder:e.$t("name")},null,8,["modelValue","label","placeholder"])]),_:1}),a(m,{cols:"12",md:"6"},{default:o(()=>[a(w,{modelValue:t.formData.phone,"onUpdate:modelValue":l[8]||(l[8]=s=>t.formData.phone=s),label:e.$t("phone"),placeholder:e.$t("phone")},null,8,["modelValue","label","placeholder"])]),_:1}),a(m,{cols:"12",md:"6"},{default:o(()=>[a(w,{modelValue:t.formData.job,"onUpdate:modelValue":l[9]||(l[9]=s=>t.formData.job=s),label:e.$t("job"),placeholder:e.$t("job")},null,8,["modelValue","label","placeholder"])]),_:1}),a(m,{cols:"12",md:"6"},{default:o(()=>[a(w,{modelValue:t.formData.registerationNumber,"onUpdate:modelValue":l[10]||(l[10]=s=>t.formData.registerationNumber=s),label:e.$t("registerationNumber"),placeholder:e.$t("registerationNumber")},null,8,["modelValue","label","placeholder"])]),_:1}),a(m,{cols:"12",md:"6"},{default:o(()=>[a(w,{modelValue:t.formData.address,"onUpdate:modelValue":l[11]||(l[11]=s=>t.formData.address=s),label:e.$t("address"),placeholder:e.$t("address")},null,8,["modelValue","label","placeholder"])]),_:1}),a(m,{cols:"12",md:"6"},{default:o(()=>[a(F,{modelValue:t.formData.cardTypeId,"onUpdate:modelValue":l[12]||(l[12]=s=>t.formData.cardTypeId=s),label:e.$t("cardTypeId"),items:t.cardTypeResponse},null,8,["modelValue","label","items"])]),_:1}),a(m,{cols:"12",md:"6"},{default:o(()=>[a(F,{modelValue:t.formData.statusId,"onUpdate:modelValue":l[13]||(l[13]=s=>t.formData.statusId=s),label:e.$t("statusId"),items:t.statusResponse},null,8,["modelValue","label","items"])]),_:1}),a(m,{cols:"12",md:"12"},{default:o(()=>[d("div",et,[d("div",tt,[d("h5",at,P(e.$t("Warrantydata")),1)])])]),_:1}),a(m,{cols:"12",md:"6"},{default:o(()=>[a(w,{modelValue:t.formData.sponsorName,"onUpdate:modelValue":l[14]||(l[14]=s=>t.formData.sponsorName=s),label:e.$t("sponsorName"),placeholder:e.$t("sponsorName")},null,8,["modelValue","label","placeholder"])]),_:1}),a(m,{cols:"12",md:"6"},{default:o(()=>[a(w,{modelValue:t.formData.sponsorPhone,"onUpdate:modelValue":l[15]||(l[15]=s=>t.formData.sponsorPhone=s),label:e.$t("sponsorPhone"),placeholder:e.$t("sponsorPhone")},null,8,["modelValue","label","placeholder"])]),_:1}),a(m,{cols:"12",class:"d-flex gap-4"},{default:o(()=>[a(C,{type:"submit",class:"d-block m-auto btn-edit"},{default:o(()=>[Q(P(e.$t("Edit")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"])]),_:1})],64)}const it=Ie(Ee,[["render",lt],["__scopeId","data-v-3995a07c"]]);export{it as default};
